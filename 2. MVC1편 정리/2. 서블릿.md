> Hello 서블릿
   - 스프링 부트 환경에서 서블릿 등로갛고 사용해보자!
   - 참고로 서블릿은 톰캣 같은 웹 애플리케이션 서버를 설치하고, 그 위에 서블릿 코드를 클래스 파일로 빌드해서 올린 다음, 톰캣 서버를 실행하면 된다. 하지만 이 과정은 매우 번거로움.. 스프링 부트는 톰캣 서버를 내장하고 있어서 톰캣 서버 설치 없이 편리하게 서블릿 코드를 실행할 수 있음!!

> 스프링 부트 서블릿 환경 구성
   - @ServletComponentScan
      - 스프링 부트는 서블릿을 직접 등록해서 사용할 수 있도록 @ServletComponentScan을 지원한다! 밑에 코드처럼 추가해보자.

> ServletApplication 코드

   ![1](https://user-images.githubusercontent.com/102012155/176996928-ebe13b5c-3c6f-4fa1-90ce-f08d8254b508.JPG)

> 서블릿 등록하기
   - 이번에는 실제 동작하는 서블릿 코드를 등록해보자!

> HelloServlet 코드

   ![2](https://user-images.githubusercontent.com/102012155/176996933-6058d49c-c459-4b0e-9c11-83c9145fd560.JPG)

   - @WebServlet 서블릿 애노테이션
      - name : 서블릿 이름
      - urlPatterns : URL 매핑
   - HTTP 요청을 통해 매핑된 URL이 호출되면 서블릿 컨테이너는 다음 메서드를 실행함!
      - protected void service(HttpServletRequest request, HttpServletResponse response)
   - 웹 브라우저 실행
      - http://localhost:8080/hello?username=world
      - 결과 : hello world
   - 콘솔 실행결과는
      
   ![3](https://user-images.githubusercontent.com/102012155/176996939-d2e3b1ac-b308-46df-9855-cf6b06fdc362.JPG)

   - 여기서 주의점은!!
      - War를 사용할 때 IntelliJ 무료버전을 사용할 경우 서버가 정상 실행이 안되면! Preferences -> Build, Execution, Deployment -> Build Tools -> Gradle에 들어가서 밑에 사진처럼 되어 있는지 확인하자 !! (윈도우는 File -> Setting)  

   ![6](https://user-images.githubusercontent.com/102012155/176996947-be30db5e-6f1f-4f65-85aa-a8b7daf3c500.JPG)

   - 그리고 밑에 코드를 불러오는 명령어는 Ctrl + O키를 눌러 service를 검색하여 밑에 사진에 있는 것을 불러오면 된다

   ![4](https://user-images.githubusercontent.com/102012155/176996951-fea59c0a-e9f2-46f9-9d49-1c2d70a36a71.JPG)

   ![5](https://user-images.githubusercontent.com/102012155/176996954-dba4259b-5cd0-41ce-a23d-6c8ea3363088.JPG)

> HTTP 요청 메시지 로그로 확인하기
   - resources폴더에 있는 application.properties에 밑에 코드를 추가해주자

   ![7](https://user-images.githubusercontent.com/102012155/176996958-cfc8ad7a-dd61-402d-9b55-d7c1243a2dbe.JPG)

   - 서버를 다시 시작하고, 요청해보면 서버가 받은 HTTP 요청 메시지를 출력하는 것을 확인 가능하다!

   ![8](https://user-images.githubusercontent.com/102012155/176996961-38d8b569-c3e4-4c8b-a81e-777f9ccc644c.JPG)

   - 참고로 운영서버에 이렇게 모든 요청 정보를 다 남기면 성능저하가 발생할 수 있다. 개발 단계에서만 적용하자!

> 서블릿 컨테이너 동작 방식

> 내장 톰캣 서버 생성 사진으로 알아보자.

   ![9](https://user-images.githubusercontent.com/102012155/176996964-0358fd5c-7a97-4c18-abeb-c55611af78de.JPG)

   - 참고로 HTTP 응답에서 Content-Length는 웹 애플리케이션 서버가 자동으로 생성해준다.
   - welcome 페이지
      - welcome 페이지를 추가해줄때 webapp 경로에 index.html을 두면 http://localhost:8080 호출 시 index.html 페이지가 열림!!

> HTTPServletRequest - 개요

> HttpServletRequest 역할은
   - HTTP 요청 메시지를 개발자가 직접 파싱해서 사용해도 되지만, 매우 불편할 것임! 서블릿은 개발자가 HTTP 요청 메시지를 편리하게 사용할 수 있도록 개발자 대신에 HTTP 요청 메시지를 파싱한다! 그리고 그 결과를 HttpServletRequest 객체에 담아서 제공한다!
   - HttpServletRequest를 사용하면 다음과 같은 HTTP 요청 메시지를 편리하게 조회할 수 있다.

> HTTP 요청 메시지

   ![10](https://user-images.githubusercontent.com/102012155/176996967-d2b428ab-8101-470c-b940-c8fc3a8f2cd8.JPG)

   - START LINE
      - HTTP 메소드
      - URL
      - 쿼리 스트링
      - 스키마, 프로토콜
   - 헤더
      - 헤더 조회
   - 바디
      - form 파라미터 형식 조회
      - message body 데이터 직접 조회
   - HttpServletRequest 객체는 추가로 여러가지 부가기능도 함께 제공한다!

> 임시 저장소 기능
   - 해당 HTTP 요청이 시작부터 끝날 때 까지 유지되는 임시 저장소 기능
      - 저장 : request.setAttribute(name, value) 
      - 조회 : request.getAttribute(name)

> 세션 관리 기능
   - reqeust.getSession(create: true)

> 중요
   - HttpServletRequest, HttpServletResponse를 사용할 때 가장 중요한 점은 이 객체들이 HTTP 요청 메시지, HTTP 응답 메시지를 편리하게 사용하도록 도와주는 객체라는 점이다! 따라서 이 기능에 대해서 깊이있는 이해를 하려면 HTTP 스펙이 제공하는 요청, 응답 메시지 자체를 이해해야 한다!

> HttpServletRequest - 기본 사용법
   - HttpServletRequest가 제공하는 기본 기능들을 알아보자.

> RequestHeaderServlet 코드

   ![11](https://user-images.githubusercontent.com/102012155/176996974-76997f43-ee72-4a50-83ef-78ee2038d94e.JPG)

> start-line 정보

   ![12](https://user-images.githubusercontent.com/102012155/176996978-3b2cd8a3-41cc-4521-b9c3-ee7ed86bcb93.JPG)

> 결과

   ![13](https://user-images.githubusercontent.com/102012155/176996985-c1a546b8-7562-4791-b79b-5398aa922f0d.JPG)

> 헤더 정보

   ![14](https://user-images.githubusercontent.com/102012155/176996987-3bcf8aa4-c15a-4480-bf0c-71a61e6df86a.JPG)

> 결과

   ![15](https://user-images.githubusercontent.com/102012155/176996994-63f4523d-a481-4c2f-9c55-d56300c30200.JPG)

> Header 편리한 조회

   ![16](https://user-images.githubusercontent.com/102012155/176996997-6c9b84f5-acf5-437e-81a9-a9d9ebe916f3.JPG)

> 결과

   ![17](https://user-images.githubusercontent.com/102012155/176996998-84b776d7-be4c-4835-be20-64987f95d3ec.JPG)

> 기타 정보
   - 기타 정보는 HTTP 메시지의 정보는 아니다.

   ![18](https://user-images.githubusercontent.com/102012155/176997000-1cdb795f-c91d-4e24-ae3b-65553b1908bc.JPG)

> 결과

   ![19](https://user-images.githubusercontent.com/102012155/176997004-f96cb7c7-121b-4c9d-aed4-38d90ba595b4.JPG)

   - 참고로 로컬에서 테스트하면 IPv6 정보가 나오는데, IPv4 정보를 보고 싶으면 
   - -Djava.net.preferIpv45Stack=true를 VM options에 넣어주면 된다
   - 지금까지는 HttpServletRequest를 통해서 HTTP 메시지의 start-line, header 정보 조회 방법을 이해했다. 이제 본격적으로 HTTP 요청 데이터를 어떻게 조회하는지 알아보자!!!

> HTTP 요청 데이터 - 개요
   - HTTP 요청 메시지를 통해 클라이언트에서 서버로 데이터를 전달하는 방법을 알아보자.

> 주로 다음 3가지 방법을 사용함!!
   - GET - 쿼리 파라미터
      - /url?username=hello&age=20
      - 메시지 바디 없이, URL의 쿼리 파라미터에 데이터를 포함해서 전달
      - 예) 검색, 필터, 페이징등에서 많이 사용하는 방식
   - POST - HTML Form
      - content-type: appliciation/x-www-form-urlencoded
      - 메시지 바디에 쿼리 파라미터 형식으로 전달 username=hello&age=20
      - 예) 회원 가입, 상품 주문, HTML Form 사용
   - HTTP message body에 데이터를 직접 담아서 요청
      - HTTP API에서 주로 사용, JSON, XML, TEXT
   - 데이터 형식은 주로 JSON 사용
      - POST, PUT, PATCH
   - POST-HTML Form 예시

   ![20](https://user-images.githubusercontent.com/102012155/176998798-55fa0cd1-0a50-40dc-8667-e8962d2fad6c.JPG)

   - 이제부터 하나씩 알아보자!

> HTTP 요청 데이터 - GET 쿼리 파라미터
   - 다음 데이터를 클라이언트에서 서버로 전송해보자.
   - 전달 데이터
      - username=hello
      - age=20
   - 메시지 바디 없이, URL의 쿼리 파라미터를 사용해서 데이터를 전달해보자.
   - 예) 검색, 필터, 페이징등에서 많이 사용하는 방식
   - 쿼리 파라미터는 URL에 다음과 같이 ?를 시작으로 보낼 수 있다. 추가 파라미터는 &로 구분하면 된다!
   - http://localhost:8080/request-param?username=hello&age=20
   - 서버에서는 HttpServletRequest가 제공하는 다음 메서드를 통해 쿼리 파라미터를 편리하게 조회할 수 있다!!

> 쿼리 파라미터 조회 메서드

   ![21](https://user-images.githubusercontent.com/102012155/176998801-697f9991-2732-415f-a736-dca06dd4ef8d.JPG)

> RequestParamServlet 코드

   ![22](https://user-images.githubusercontent.com/102012155/176998803-c510d139-2aaf-43b1-87eb-799f2bd29d25.JPG)

> 실행 - 파라미터 전송
   - http://localhost:8080/request-param?username=hello&age=20

> 결과

   ![23](https://user-images.githubusercontent.com/102012155/176998807-29316fa8-1ca9-46bd-808f-6ee616c608a0.JPG)

> 실행 - 동일 파라미터 전송
   - http://localhost:8080/request-param?username=hello&username=kim&age=20

> 결과

   ![24](https://user-images.githubusercontent.com/102012155/176998809-5fdc824c-e969-4a4a-b592-2009f881a763.JPG)

> 복수 파라미터에서 단일 파라미터 조회
   - username=hello&username=kim과 같이 파라미터 이름은 하나인데 값이 중복이면 어떻게 될까?? request.getParameter()는 하나의 파라미터 이름에 대해서 단 하나의 값만 있을 때 사용해야 함! 지금처럼 중복일 때는 request.getParameterValues()를 사용해야 한다!! 참고로 이렇게 중복일 때 request.getParameter()를 사용하면 request.getParameterValues()의 첫번째 값을 반환함!!
